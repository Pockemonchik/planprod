{% extends "base.html" %}
{%load static%}
{% block content %}
<html>
<head>
    <link rel="stylesheet" href="{% static "/css/sotr_umr.css" %}" />
    <script type="text/javascript" src="{% static "/js/graph.js" %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="{% static "/js/vue.js" %}"></script>
    <script src="{% static "/js/axios.js" %}"></script>
</head>
<body>
    <div class="content active">
        <div class="container-fluid">
          <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12">
                <div class="btn-center">
                    <a role="button" class="button-block "><button>Просмотр индивидуального  рейтинга <br> сотрудника кафедры</button></a>
                    <a role="button" class="button-block button-right"><button>Просмотр общего рейтинга <br> по кафедре</button></a>
                    <a role="button" class="button-block button-right"><button>Просмотр по должностным категориям <br> по кафедре</button></a>
                    <a role="button" class="button-block button-right"><button>Просмотр межкафедрального <br> рейтинга</button></a>
                </div>
                <div class="flex-block">
                    <div class="sotr-block" id="app">
                        <select class="sotr-select" v-model="kaf" @change="onChangeKaf($event)">
                          <option v-for="(foo) in resultKaf" :value="foo.fullname">{foo.fullname}</option>
                        </select>
                        <select class="sotr-select" v-model="man" @change="onChangeMan($event)">
                          <option v-for="(value) in resultMan" :value=value.fullname>{value.fullname}</option>
                        </select>
                        <div class="table-responsive table-width">
                            <table class="table table-bordered table-hover " data-tablesaw-mode="columntoggle" data-tablesaw-minimap>
                                <tr>
                                  <th>Учебная работа </th>
                                    <td><input class="input-width" v-model="urr"></td>
                                </tr>
                                <tr>
                                  <th>Организационно-методическая работа</th>
                                  <td><input class="input-width"v-model="ormr"></td>
                                </tr>
                                <tr>
                                  <th>Подготовка учебно методических материалов</th>
                                  <td><input class="input-width" v-model="mrr"></td>
                                </tr>
                                <tr>
                                    <th>Педагогический контроль</th>
                                    <td><input class="input-width" v-model="pcr"></td>
                                  </tr>
                            </table>
                        </div>
                        <div class="table-responsive table-width">
                            <table class="table table-bordered table-hover " data-tablesaw-mode="columntoggle" data-tablesaw-minimap>
                                <tr>
                                  <th>Сумма рейтинговых баллов </th>
                                    <td><input class="input-width"></td>
                                </tr>
                                <tr>
                                  <th>Место на кафедре</th>
                                  <td><input class="input-width"></td>
                                </tr>
                                <tr>
                                  <th>Место в университете по должностной категории</th>
                                  <td><input class="input-width"></td>
                                </tr>
                                <tr>
                                    <th>Место в университете по всему ППС</th>
                                    <td><input class="input-width"></td>
                                  </tr>
                            </table>
                        </div>
                    </div>
                    <div class="graph-block">

                        <div id="graphic1">
                            <p>общий рейтинг</p>
                        </div>
                        <div id="graphic2">
                            <p>по должностыным категориям</p>
                        </div>
                        <div id="graphic3">
                            <p>межкафедральный рейтинг</p>
                        </div>
                    </div>
                    <script>
                        var options = {
                          series: [{
                          name: 'PRODUCT A',
                          data: [44, 55, 41, 67, 22, 43]
                        }, {
                          name: 'PRODUCT B',
                          data: [13, 23, 20, 8, 13, 27]
                        }, {
                          name: 'PRODUCT C',
                          data: [11, 17, 15, 15, 21, 14]
                        }, {
                          name: 'PRODUCT D',
                          data: [21, 7, 25, 13, 22, 8]
                        }],
                          chart: {
                          type: 'bar',
                          height: 500,
                          width:400,
                          stacked: true,
                          toolbar: {
                            show: true
                          },
                          zoom: {
                            enabled: true
                          }
                        },
                        responsive: [{
                          breakpoint: 480,
                          options: {
                            legend: {
                              position: 'bottom',
                              offsetX: -10,
                              offsetY: 0
                            }
                          }
                        }],
                        plotOptions: {
                          bar: {
                            horizontal: false,
                          },
                        },
                        xaxis: {
                          type: 'datetime',
                          categories: ['01/01/2011 GMT', '01/02/2011 GMT', '01/03/2011 GMT', '01/04/2011 GMT',
                            '01/05/2011 GMT', '01/06/2011 GMT'
                          ],
                        },
                        legend: {
                          position: 'right',
                          offsetY: 40
                        },
                        fill: {
                          opacity: 1
                        }
                        };
                
                        var chart = new ApexCharts(document.querySelector("#graphic1"), options);
                        chart.render();
                    </script>
                    <script>
                        var options = {
                          series: [{
                          name: 'PRODUCT A',
                          data: [44, 55, 41, 67, 22, 43]
                        }, {
                          name: 'PRODUCT B',
                          data: [13, 23, 20, 8, 13, 27]
                        }, {
                          name: 'PRODUCT C',
                          data: [11, 17, 15, 15, 21, 14]
                        }, {
                          name: 'PRODUCT D',
                          data: [21, 7, 25, 13, 22, 8]
                        }],
                          chart: {
                          type: 'bar',
                          height: 500,
                          width:400,
                          stacked: true,
                          toolbar: {
                            show: true
                          },
                          zoom: {
                            enabled: true
                          }
                        },
                        responsive: [{
                          breakpoint: 480,
                          options: {
                            legend: {
                              position: 'bottom',
                              offsetX: -10,
                              offsetY: 0
                            }
                          }
                        }],
                        plotOptions: {
                          bar: {
                            horizontal: false,
                          },
                        },
                        xaxis: {
                          type: 'datetime',
                          categories: ['01/01/2011 GMT', '01/02/2011 GMT', '01/03/2011 GMT', '01/04/2011 GMT',
                            '01/05/2011 GMT', '01/06/2011 GMT'
                          ],
                        },
                        legend: {
                          position: 'right',
                          offsetY: 40
                        },
                        fill: {
                          opacity: 1
                        }
                        };
                
                        var chart = new ApexCharts(document.querySelector("#graphic2"), options);
                        chart.render();
                    </script>
                    <script>
                        var options = {
                          series: [{
                          name: 'PRODUCT A',
                          data: [44, 55, 41, 67, 22, 43]
                        }, {
                          name: 'PRODUCT B',
                          data: [13, 23, 20, 8, 13, 27]
                        }, {
                          name: 'PRODUCT C',
                          data: [11, 17, 15, 15, 21, 14]
                        }, {
                          name: 'PRODUCT D',
                          data: [21, 7, 25, 13, 22, 8]
                        }],
                          chart: {
                          type: 'bar',
                          height: 500,
                          width:400,
                          stacked: true,
                          toolbar: {
                            show: true
                          },
                          zoom: {
                            enabled: true
                          }
                        },
                        responsive: [{
                          breakpoint: 480,
                          options: {
                            legend: {
                              position: 'bottom',
                              offsetX: -10,
                              offsetY: 0
                            }
                          }
                        }],
                        plotOptions: {
                          bar: {
                            horizontal: false,
                          },
                        },
                        xaxis: {
                          type: 'datetime',
                          categories: ['01/01/2011 GMT', '01/02/2011 GMT', '01/03/2011 GMT', '01/04/2011 GMT',
                            '01/05/2011 GMT', '01/06/2011 GMT'
                          ],
                        },
                        legend: {
                          position: 'right',
                          offsetY: 40
                        },
                        fill: {
                          opacity: 1
                        }
                        };
                
                        var chart = new ApexCharts(document.querySelector("#graphic3"), options);
                        chart.render();
                    </script>
                </div>
            </div>
          </div>
        </div>
    </div>
    <script id='INLINE_PEN_JS_ID'>
      const urlkaf = "http://192.168.0.18:8000/rating/kafedras"
      const urlman = "http://192.168.0.18:8000/rating/profiles"
      const urlpar = "http://192.168.0.18:8000/rating/profilerating"
      var app = new Vue({
        delimiters:['{','}'],
        el: '#app',
        data: {
          kaf: "",
          man: "",
          resultKaf: "",
          resultMan: "",
          resultParams: "",
          urr: "",
          ormr: "",
          mrr: "",
          pkr: ""
        },
        methods: {
          onChangeKaf(event){
          axios.get(urlman, {params: {kafedra:this.kaf}}).then(response => {
            this.resultMan = response.data;
            this.urr=""
            this.ormr=""
            this.mrr=""
            this.pcr=""
          })
          },
          onChangeMan(event){
            this.urr=""
            this.ormr=""
            this.mrr=""
            this.pcr=""
            axios.get(urlpar, {params: {profile:this.man}}).then(response => {
              this.resultParams = response.data;
              console.log(this.resultParams)
              this.urr=this.resultParams[0].urr
              this.ormr=this.resultParams[0].ormr
              this.mrr=this.resultParams[0].mrr
              this.pcr=this.resultParams[0].pcr
          })
          }
        },
        mounted() {
          axios.get(urlkaf).then(response => {
            this.resultKaf = response.data;
          })
        },
      });
      
    </script>
</body>
</html>
{% endblock %}